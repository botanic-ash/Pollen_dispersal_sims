total_names = names(parental_allele_list)
total = total + n_distinct(total_names) #getting the number of distinct values for locus 1 to count alleles
k = k+2 #increment k for next loop iteration
}
#All same pollen scenarios
#for each element in scenario list--for 'all same' sampling (defined in defining_function_parameters.R file)
for(x in 1:length(all_same_params)) {
#call the function using that scenario and save the function return in temp
temp = sample_seed(genetic_data, all_same_params[[x]][[1]], all_same_params[[x]][[2]], all_same_params[[x]][[3]], all_same_params[[x]][[4]])
#calculating proportion of alleles captured
captured = 0 #sum to keep track of alleles captured by sampling
j=1 #counter variable to column (locus) of seed dataset
for(z in 1:num_loci) {
seed_allele_list = table(c(as.matrix(temp[,j:(j+1)]))) #getting unique values for locus i in seed dataframe
captured_names = names(seed_allele_list)#getting the names of the alleles captured from sampling
captured = captured + n_distinct(captured_names)#making sure none of the super rare alleles excluded from parental dataset are included here
j = j+2 #increment j for next loop iteration
}
prop_capt_all_same[x,1,i] = (captured/total)#proportion of alleles captured = captured/total, save these results
prop_capt_all_same[x,2,i] = sum(all_same_params[[x]][[2]])#total seeds sampled --if possible, change all_same_params[[x]][[2]][[1]] hard coding
prop_capt_all_same[x,3,i] = (all_same_params[[x]][[1]]) #number of trees sampled
prop_capt_all_same[x,5,i] = captured
#clearing out containers
rm(captured_names)
rm(seed_allele_list)
rm(temp)
}
#defining these columns with vectors to speed up code
prop_capt_all_same[,4,i] = "all_same"
prop_capt_all_same[,6,i] = total
prop_capt_all_same[,7,i] = i
#'all eligible' sampling
for(x in 1:length(all_eligible_params)) {
#call the function using that scenario and save the function return in temp
temp = sample_seed(genetic_data, all_eligible_params[[x]][[1]], all_eligible_params[[x]][[2]], all_eligible_params[[x]][[3]], all_eligible_params[[x]][[4]])
#calculating proportion of alleles captured
#calculating proportion of alleles captured
captured = 0 #sum to keep track of alleles captured by sampling
j=1 #counter variable to column (locus) of seed dataset
for(z in 1:num_loci) {
seed_allele_list = table(c(as.matrix(temp[,j:(j+1)]))) #getting unique values for locus i in seed dataframe
captured_names = names(seed_allele_list)#getting the names of the alleles captured from sampling
captured = captured + n_distinct(captured_names)#making sure none of the super rare alleles excluded from parental dataset are included here
j = j+2 #increment j for next loop iteration
}
prop_capt_all_eligible[x,1,i] = (captured/total) #proportion of alleles captured= captured/total
prop_capt_all_eligible[x,2,i] = sum(all_eligible_params[[x]][[2]])#total seeds sampled
prop_capt_all_eligible[x,3,i] = (all_eligible_params[[x]][[1]]) #number of trees sampled
prop_capt_all_eligible[x,5,i] = captured
#clearing out containers
rm(captured_names)
rm(seed_allele_list)
rm(temp)
}
prop_capt_all_eligible[,4,i] = "all_eligible"
prop_capt_all_eligible[,6,i] = total
prop_capt_all_eligible[,7,i] = i
#skewed sampling
for(x in 1:length(skewed_params)) {
temp = sample_seed(genetic_data, skewed_params[[x]][[1]], skewed_params[[x]][[2]], skewed_params[[x]][[3]], skewed_params[[x]][[4]])
#calculating proportion of alleles captured
captured = 0 #sum to keep track of alleles captured by sampling
j=1 #counter variable to column (locus) of seed dataset
for(z in 1:num_loci) {
seed_allele_list = table(c(as.matrix(temp[,j:(j+1)]))) #getting unique values for locus i in seed dataframe
captured_names = names(seed_allele_list)#getting the names of the alleles captured from sampling
captured = captured + n_distinct(captured_names)#making sure none of the super rare alleles excluded from parental dataset are included here
j = j+2 #increment j for next loop iteration
}
prop_capt_skewed[x,1,i] = (captured/total)#proportion of alleles captured = captured/ total
prop_capt_skewed[x,2,i] = sum(skewed_params[[x]][[2]])#total seeds sampled
prop_capt_skewed[x,3,i] = (skewed_params[[x]][[1]]) #number of trees sampled
prop_capt_skewed[x,5,i] = captured
#clearing out containers
rm(captured_names)
rm(seed_allele_list)
rm(temp)
}
prop_capt_skewed[,4,i] = "skewed"
prop_capt_skewed[,6,i] = total
prop_capt_skewed[,7,i] = i
rm(total_names)
rm(parental_allele_list)
}
<<<<<<< HEAD
colnames(prop_capt_all_same) = c("prop_capt", "total_seeds", "maternal_trees", "donor_type", "num_capt", "total_alleles", "replicate")
colnames(prop_capt_all_eligible) = c("prop_capt", "total_seeds", "maternal_trees",  "donor_type", "num_capt", "total_alleles", "replicate")
colnames(prop_capt_skewed) = c("prop_capt", "total_seeds", "maternal_trees", "donor_type", "captured", "total_alleles", "replicate")
#saving ideal results to Rdata file
save(prop_capt_all_same, prop_capt_all_eligible, prop_capt_skewed, file="R-scripts/Rdata/alleles_capt_ideal_onepop.Rdata")
getwd()
setwd("C:/Users/kayle/Documents/Pollen_dispersal_sims")
#saving ideal results to Rdata file
save(prop_capt_all_same, prop_capt_all_eligible, prop_capt_skewed, file="R-scripts/Rdata/alleles_capt_ideal_onepop.Rdata")
View(pop_capt_all_same[,,1])
View(prop_capt_all_same[,,1])
=======
colnames(prop_capt_all_same) = c("prop_capt", "total_seeds", "maternal_trees", "num_donors", "donor_type")
colnames(prop_capt_all_eligible) = c("prop_capt", "total_seeds", "maternal_trees", "num_donors", "donor_type")
colnames(prop_capt_skewed) = c("prop_capt", "total_seeds", "maternal_trees", "num_donors", "donor_type")
#saving SKEWED results to Rdata file
save(prop_capt_all_same, prop_capt_all_eligible, prop_capt_skewed, file="R-scripts/prop_alleles_capt_realistic_two_pop.Rdata")
######################################################################################
#Plotting confidence and prediction intervals
#14 September 2022
######################################################################################
library(dplyr)
#load in data
drug_group = read.csv("hw6_week5mon/drug_group_treatment.csv")
#preliminary plot to visualize data
plot(drug_group$Change~drug_group$Cholesterol)
######################################################################################
#fitting a linear model to the data
fit = lm(drug_group$Change~drug_group$Cholesterol)
#libraries
library(dplyr)
library(tidyr)
library(ggplot2)
theme_set(theme_bw())
#load in data
load("R-scripts/Rdata/alleles_capt_ideal_onepop.Rdata")
View(prop_capt_all_same)
View(prop_capt_all_same[,,1])
same_long = matrix(prop_capt_all_same, 935*50, 7)
View(same_long)
dim(prop_capt_all_same) = c(935*50, 7)
view(prop_capt_all_same)
View(prop_capt_all_same)
#load in data
load("R-scripts/Rdata/alleles_capt_ideal_onepop.Rdata")
lapply(rbind(prop_capt_all_same[,,i]))
lapply(prop_capt_all_same, rbind(prop_capt_all_same[,,i]))
lapply(prop_capt_all_same, rbind)
same_long = lapply(prop_capt_all_same, rbind)
View(same_long)
same_long = NULL
#load in data
load("R-scripts/Rdata/alleles_capt_ideal_onepop.Rdata")
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,i], prop_capt_all_same[,,(i+1)])
same_long = rbind(same_long, temp)
i = i+1
}
View(same_long)
table(same_long$replicate)
table(same_long[,7])
for(i in 1:50) {
print(i)
temp = rbind(prop_capt_all_same[,,i], prop_capt_all_same[,,(i+1)])
same_long = rbind(same_long, temp)
i = i+1
print(i)
}
for(i in 0:50) {
print(i)
i = i+1
temp = rbind(prop_capt_all_same[,,i], prop_capt_all_same[,,(i+1)])
same_long = rbind(same_long, temp)
print(i)
}
for(i in 0:50) {
print(i)
i = i+1
temp = rbind(prop_capt_all_same[,,i], prop_capt_all_same[,,(i+1)])
same_long = rbind(same_long, temp)
i = i+1
print(i)
}
for(i in 1:50) {
print(i)
temp = rbind(prop_capt_all_same[,,i], prop_capt_all_same[,,(i+1)])
same_long = rbind(same_long, temp)
i = i+1
print(i)
}
for(i in 1:50) {
j=1
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+1
print(i)
}
table(same_long[,7])
1   10   11   12   13   14   15   16   17   18   19    2   20   21   22   23   24   25   26
table(same_long[,7])
same_long=NULL
for(i in 1:50) {
j=1
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+1
print(i)
}
talbe(same_long[,7])
table(same_long[,7])
for(i in 1:50) {
j=1
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+1
print(i)
}
same_long=NULL
#load in data
load("R-scripts/Rdata/alleles_capt_ideal_onepop.Rdata")
for(i in 1:50) {
j=1
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+1
print(i)
}
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+1
}
same_long=NULL
#load in data
load("R-scripts/Rdata/alleles_capt_ideal_onepop.Rdata")
j=1
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+1
print(j)
}
j=1
same_long=NULL
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+2
print(j)
}
View(same_long)
#Here we
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,i], prop_capt_all_same[,,(i+1)])
same_long = rbind(same_long, temp)
i = i+2
print(i)
}
same_long=NULL
#Here we
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,i], prop_capt_all_same[,,(i+1)])
same_long = rbind(same_long, temp)
i = i+2
print(i)
}
same_long=NULL
#Here we
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,i], prop_capt_all_same[,,(i+1)])
same_long = rbind(same_long, temp)
i = i+2
print(i)
}
table(same_long[,7])
#Here we
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+2
print(j)
}
table(same_long[,7])
same_long=NULL
#Here we
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+2
print(j)
}
table(same_long[,7])
#Converting 3D results matrices to 2D for plotting and analysis purposes
#This is considered tidy format?
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+2
print(j)
}
same_long=NULL
#Converting 3D results matrices to 2D for plotting and analysis purposes
#This is considered tidy format?
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+2
print(j)
}
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_eligible[,,j], prop_capt_all_eligible[,,(j+1)])
eligible_long = rbind(eligible_long, temp)
j = j+2
print(j)
}
j=1
for(i in 1:50) {
temp = rbind(prop_capt_skewed[,,j], prop_capt_skewed[,,(j+1)])
skewed_long = rbind(skewed_long, temp)
j = j+2
print(j)
}
#binding all dataframes together into one huge dataframe
#This is considered tidy format?
rbind(same_long, eligible_long, skewed_long)
same_long=NULL
#Converting 3D results matrices to 2D for plotting and analysis purposes
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+2
}
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_eligible[,,j], prop_capt_all_eligible[,,(j+1)])
eligible_long = rbind(eligible_long, temp)
j = j+2
}
#Converting 3D results matrices to 2D for plotting and analysis purposes
same_long=NULL
eligible_long=NULL
skewed_long=NULL
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_same[,,j], prop_capt_all_same[,,(j+1)])
same_long = rbind(same_long, temp)
j = j+2
}
j=1
for(i in 1:50) {
temp = rbind(prop_capt_all_eligible[,,j], prop_capt_all_eligible[,,(j+1)])
eligible_long = rbind(eligible_long, temp)
j = j+2
}
j=1
for(i in 1:50) {
temp = rbind(prop_capt_skewed[,,j], prop_capt_skewed[,,(j+1)])
skewed_long = rbind(skewed_long, temp)
j = j+2
print(j)
}
rm(temp)
#binding all dataframes together into one huge dataframe
#This is considered tidy format?
rbind(same_long, eligible_long, skewed_long)
#binding all dataframes together into one huge dataframe
#This is considered tidy format?
tidy_df = rbind(same_long, eligible_long, skewed_long)
View(tidy_df)
#Plot of total alleles present in simulations--to see the distribution of variation between simulation replicates
ggplot(tidy_df, aes(x=total_alleles)) +
geom_histogram()
tidy_df = as.data.frame()
tidy_df = as.data.frame(tidy_df)
#Plot of total alleles present in simulations--to see the distribution of variation between simulation replicates
ggplot(tidy_df, aes(x=total_alleles)) +
geom_histogram()
#Plot of total alleles present in simulations--to see the distribution of variation between simulation replicates
ggplot(tidy_df, aes(x=total_alleles)) +
geom_histogram(stat=count)
#Plot of total alleles present in simulations--to see the distribution of variation between simulation replicates
ggplot(tidy_df, aes(x=total_alleles)) +
geom_histogram(stat="count")
#Plot of total alleles present in simulations--to see the distribution of variation between simulation replicates
ggplot(tidy_df, aes(x=total_alleles)) +
geom_bar()
#Plot of total alleles present in simulations--to see the distribution of variation between simulation replicates
ggplot(tidy_df, aes(x=unique(total_alleles))) +
geom_bar()
#Plot of total alleles present in simulations--to see the distribution of variation between simulation replicates
ggplot(tidy_df, aes(x=total_alleles)) +
geom_bar()
table(unique(total_alleles))
table(unique(tidy_df$total_alleles))
table(total_alleles)
table(tidy_df$total_alleles)
tidy_df %>%
group_by(replicate)
#Plot of total alleles present in simulations--to see the distribution of variation between simulation replicates
ggplot(tidy_df, aes(x=total_alleles)) +
geom_bar() +
geom_smooth()
#Plot of total alleles present in simulations--to see the distribution of variation between simulation replicates
ggplot(tidy_df, aes(x=total_alleles)) +
geom_bar()
#
ggplot(tidy_df, aes(x=maternal_trees, y=prop_capt, color=donor_type)) +
geom_point() +
geom_smooth()
#Plotting curves
tidy_df %>%
filter(maternal_trees==1) %>%
ggplot(aes(x=total_seeds, y=prop_capt)) +
geom_smooth()
tidy_df %>% filter(maternal_trees==1)
#Plotting curves
tidy_df %>%
filter(maternal_trees==1) %>%
ggplot(aes(x=total_seeds, y=prop_capt), group=donor_type) +
geom_smooth()
#Plotting curves
tidy_df %>%
filter(maternal_trees==1) %>%
ggplot(aes(x=total_seeds, y=prop_capt), group=donor_type) +
geom_point()
#Plotting curves
tidy_df %>%
filter(maternal_trees==1) %>%
ggplot(aes(x=total_seeds, y=prop_capt), fill=donor_type) +
geom_point() +
geom_jitter() +
xlab(NULL) +
ylab(NULL)
#Plotting curves
tidy_df %>%
filter(maternal_trees==1) %>%
ggplot(aes(x=total_seeds, y=prop_capt, color=donor_type)) +
geom_point() +
geom_jitter() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
temp = tidy_df %>% filter(maternal_trees==1)
View(temp)
#Plotting curves
tidy_df %>%
filter(maternal_trees==1) %>%
order(total_seeds, decreasing = FALSE) %>%
ggplot(aes(x=total_seeds, y=prop_capt, color=donor_type)) +
geom_point() +
geom_jitter() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
#Plotting curves
tidy_df %>%
filter(maternal_trees==1) %>%
order(tidy_df$total_seeds, decreasing = FALSE) %>%
ggplot(aes(x=total_seeds, y=prop_capt, color=donor_type)) +
geom_point() +
geom_jitter() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
#Plotting curves
tidy_df %>%
filter(maternal_trees==1) %>%
ggplot(aes(x=total_seeds, y=num_capt, color=donor_type)) +
geom_point() +
geom_jitter() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
#Plotting curves
tidy_df %>%
filter(maternal_trees==1) %>%
ggplot(aes(x=total_seeds, y=prop_capt, color=donor_type)) +
geom_point(alpha=0.5) +
geom_jitter() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
#Plotting curves
tidy_df %>%
ggplot(aes(x=total_seeds, y=prop_capt, color=donor_type)) +
geom_point(alpha=0.25) +
geom_jitter() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
facet_wrap(maternal_trees)
#Plotting curves
tidy_df %>%
ggplot(aes(x=total_seeds, y=prop_capt, color=donor_type)) +
geom_point(alpha=0.25) +
geom_jitter() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
facet_wrap(vars(maternal_trees))
#Plotting curves
tidy_df %>%
filter(total_seeds==100) %>%
ggplot(aes(x=total_seeds, y=prop_capt, color=donor_type)) +
geom_point(alpha=0.25) +
geom_jitter() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
facet_wrap(vars(maternal_trees))
>>>>>>> 9a7801144ef32f8c8337959219542b000ee1ee59
